<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Webflow -> Drupal</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="bootstrap.css" media="screen">
    <link rel="stylesheet" href="assets/css/custom.min.css">
  </head>
  <body>
    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a href="index.html" class="navbar-brand">Webflow -> Drupal</a>
        </div>
        <div class="navbar-collapse collapse" id="navbar-main">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="code">Custom Pane <span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="code">
                <li><a href="custom-pane.html">custom pane code</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>


    <div class="container">
      <div class="jumbotron">
  <h1>Custom Panes</h1>
  <p>Let get to it.</p>
</div>
     
      <!-- Site
      ================================================== -->
      <div class="bs-docs-section">
        <div class="page-header">
          <div class="row">
            <div class="col-lg-12">
              <h1 id="site">Setting up new Custom Pane</h1>
              <p>Custom panes are base out of two files .inc and a tlp.php file.</p>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-12">
             <h2>Sample inc file</h2>
             <p>In here you can see how the complete .inc file will look like once is build.</p>
              <p>Important Thing to look at the $pugins variable, form edit function and render function.</p>
            <img src="images/inc.png" alt="files">
            <h2>Sample tlp file</h2>
            <p>Here we can have a look at where is the content that we need to be dynamic</p>
             <img src="images/tpl.png" alt="files">
          </div>
        </div>
      </div>

        <!-- drush
      ================================================== -->
      <div class="bs-docs-section">
        <div class="page-header">
          <div class="row">
            <div class="col-lg-12">
              <h1 id="drush">Create your first custom pane</h1>
              <p>create a new folder, make sure to name the folder and files the same see image bellow:</p>
              <img src="images/name.png" alt="files">
            </div>
          </div>
        </div>

       

        <div class="row">
          <div class="col-lg-12">
            <h1>let's start!</h1>
            <p>The plugin variable here is we are going to name and create fields in the form API.</p>
            <ul>
              <li>Title: name of the custom pane</li>
              <li>Description: description of the custom pane</li>
              <li>category: where does the custom pane belongs to: front page, about, footer</li>
              <li>edit form: name of the edit function</li>
              <li>render callback: name of the render function</li>
              <li>defaults: fields you want the custom pane to have..</li>
            </ul>
            <p></p>
            <pre> $plugin = array(
                  // 'single' => TRUE,
                  'title' => t(''.$pane_name.''),
                  'description' => t(''.$pane_name.''),
                  'category' => t('Custom Panes'),
                  'edit form' => ''.$form_name.'_edit_form',
                  'render callback' => ''.$form_name.'_render',
                  // need to have default value
                  'defaults' => array(
                    'logo' => '',
                    'email' => '',
                    'poetic' => '',

                  )
                );
            </pre>
            <p>You need to add more fields? start here</p>
            <p>This is a sample on how to add new fields or creating the default array from scratch</p>
            <pre>  
                  'defaults' => array(
                    'logo' => '',
                    'email' => '',
                    'poetic' => '',
                    'new_field' => '',
                    'test_field' => '',
                    'better_field' => '',

                  )
            </pre>
          </div>
        </div>

         <div class="row">
          <div class="col-lg-12">
            <h1>The Edit form function:</h1>
            <pre>function footer_edit_form($form, &$form_state) {
  $conf = $form_state['conf'];
  //field logo
  $form['logo'] = array(
    //title
    '#title'  =>  t('logo'),
    //type please read (https://api.drupal.org/api/drupal/developer!topics!forms_api_reference.html/7#type).
    '#type' => 'managed_file',
    //most commonly use text_format, textfield, fieldset, managed_file
    '#upload_location' => 'public://usage/',
    //description of the field this will show in the Pane
    '#description' => t('Upload Logo'),
    //validation for uplaod field.
    "#upload_validators"  => array("file_validate_extensions" => array("png gif jpg svg")),
    //default value so is value is not empty get the vaule from the field else is null
    '#default_value' => !empty($conf['logo']) ? $conf['logo'] : null
  );

  //  ckeditor type field
  //  $form['longtext'] = array(
  //   '#title'  =>  t('longtext'),
  //   '#type' => 'text_format',
  //   '#default_value' => !empty($conf['longtext']['value']) ? $conf['longtext']['value'] : null,
   //  other formats: full_html, no_formatting, filtered_html, plain_text
  //   '#format' => 'full_html'
  // );

  $form['email'] = array(
    '#title'  =>  t('email'),
    '#type' => 'textfield',
    '#default_value' => isset($conf['email']) ? $conf['email'] : null,
  );
  $form['poetic'] = array(
    '#title'  =>  t('poetic logo'),
    '#type' => 'managed_file',
    '#upload_location' => 'public://usage/',
    '#description' => t('Upload poetic logo'),
    "#upload_validators"  => array("file_validate_extensions" => array("png gif jpg svg")),
    '#default_value' => !empty($conf['poetic']) ? $conf['poetic'] : null
  );

  ctools_form_include($form_state, 'content');
  // Include this plugin file as well, so that when the form is rebuilt, it
  // can successfully retrieve the settings form.
  //must changer per custom pane: name 'footer', 'custom-panes/footer' EX:
  //($form_state,'newcustom', 'webflow', 'custom-panes/newcustom');
  ctools_form_include($form_state,'footer', 'webflow', 'custom-panes/footer');

  return $form;

}
            </pre>
            <p>Remember those new fields</p>
            <pre>
$form['new_field'] = array(
    //title
    '#title'  =>  t('new_field'),
    //type please read (https://api.drupal.org/api/drupal/developer!topics!forms_api_reference.html/7#type).
    '#type' => 'textfield',
    //most commonly use text_format, textfield, fieldset, managed_file
    //default value so is value is not empty get the vaule from the field else is null
    '#default_value' => !empty($conf['new_field']) ? $conf['new_field'] : null
  );
   $form['test_field'] = array(
    //title
    '#title'  =>  t('test field'),
    //type please read (https://api.drupal.org/api/drupal/developer!topics!forms_api_reference.html/7#type).
    '#type' => 'text_format',
    //most commonly use text_format, textfield, fieldset, managed_file
    '#description' => t('Upload Logo'),
    //default value so is value is not empty get the vaule from the field else is null
    '#default_value' => !empty($conf['test_field']['value']) ? $conf['test_field']['value'] : null
  );
    $form['better_field'] = array(
    //title
    '#title'  =>  t('better field'),
    //type please read (https://api.drupal.org/api/drupal/developer!topics!forms_api_reference.html/7#type).
    '#type' => 'managed_file',
    //most commonly use text_format, textfield, fieldset, managed_file
    '#upload_location' => 'public://usage/',
    //description of the field this will show in the Pane
    '#description' => t('better field'),
    //validation for uplaod field.
    "#upload_validators"  => array("file_validate_extensions" => array("png gif jpg svg")),
    //default value so is value is not empty get the vaule from the field else is null
    '#default_value' => !empty($conf['better_field']) ? $conf['better_field'] : null
  );
            </pre>
          </div>
        </div>

         <div class="row">
          <div class="col-lg-12">
            <h1>The Render function:</h1>
            <img src="images/render.png" alt="files">

            <pre>
function footer_render($subtype, $conf, $panel_args, $context = NULL) {
  $block = new stdClass();
//create varible for each field
  $logo = $conf['logo'];
  //images need this to render url instead of an interger..
  if($conf['logo']!= 0) {
    $file = file_load($conf['logo']);
    $file_url = file_create_url($file->uri);
    $logo = $file_url;
  }
//create varible for each field
  $email = $conf['email'];
//create varible for each field
  $poetic = $conf['poetic'];
  //images need this to render url instead of an interger..
  if($conf['poetic']!= 0) {
    $file = file_load($conf['poetic']);
    $file_url = file_create_url($file->uri);
    $poetic = $file_url;
  }

  $new_field = $conf['new_field'];
  $test_field = $conf['test_field']['value'];
  
  $better_field = $conf['better_field'];
  if($conf['better_field']!= 0) {
    $file = file_load($conf['better_field']);
    $file_url = file_create_url($file->uri);
    $better_field = $file_url;
  }


  $block->title = '';
  // call your varible inside the array ('logo' => $logo,)
  $block->content = theme('footer', array('logo' => $logo, 'email' => $email, 'poetic' => $poetic, 'new_field' => $new_field, 'test_field' => $test_field, 'better_field' => $better_field));
  return $block;
}
            </pre>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-12">
            <h1>The TPL..</h1>
            <h2>from this:</h2>
            <img src="images/step.png" alt="files">

            <h2>to:</h2>
            <img src="images/step2.png" alt="files">
            <h1>new fields</h1>
             <img src="images/step3.png" alt="files">
          
          </div>
        </div>


        <div class="row">
          <div class="col-lg-12">
            <h1>Function names most be unique..</h1>
            <img src="images/function.png" alt="files">
          </div>
        </div>

         <div class="row">
          <div class="col-lg-12">
            <h1>go to the webflow.module</h1>
            <img src="images/module.png" alt="files">
          </div>
        </div>


        <div class="row">
          <div class="col-lg-12">
            <h1>add your new custom pane under $panes array Ex: </h1>
            <pre>'secondary'</pre>
            <img src="images/add-custom.png" alt="files">
          </div>
        </div>

        <div class="row">
          <div class="col-lg-12">
            <h1>Congrat custom pane One is ready!</h1>
          </div>
        </div>

      </div>

      <footer>
        <div class="row">
          <div class="col-lg-12">           
            <!-- <p>Made by Juan Cubeddu</p> -->
          </div>
        </div>
      </footer>

    </div>


    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="assets/js/custom.js"></script>
  </body>
</html>
